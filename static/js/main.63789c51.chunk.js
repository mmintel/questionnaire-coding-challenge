(this["webpackJsonpquestionnaire-coding-challenge"]=this["webpackJsonpquestionnaire-coding-challenge"]||[]).push([[0],{42:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),c=n(27),i=n.n(c),s=n(29),o=n(3),u=n(7),l=n(13),h=n(12),d=n(0),j=function(e){var t=e.className,n=Object(l.a)(e,["className"]);return Object(d.jsx)("button",Object(u.a)({className:Object(h.a)("bg-blue-700 py-2 px-4 text-white rounded-full hover:bg-blue-600 focus:outline-none",t)},n))},f=function(e){var t=e.children,n=e.className,a=Object(l.a)(e,["children","className"]);return Object(d.jsx)("div",Object(u.a)(Object(u.a)({className:Object(h.a)("w-screen h-screen flex items-center justify-center flex-col",n)},a),{},{children:t}))},b=function(){var e=Object(o.g)();return Object(d.jsx)(f,{children:Object(d.jsx)(j,{onClick:function(){e.push("/question")},children:"Start Questionnaire"})})},O=n(6),v=n.n(O),p=n(10),m=n(18),x=r.a.createContext({}),y=function(){return Object(a.useContext)(x)},g=function(e){var t=e.className,n=e.children,a=Object(l.a)(e,["className","children"]);return Object(d.jsx)("div",Object(u.a)(Object(u.a)({className:Object(h.a)("w-full max-w-2xl mx-auto my-8 px-2",t)},a),{},{children:Object(d.jsx)("div",{children:n})}))},w=function(e){var t=e.tag,n=e.size,a=e.children,r=e.className,c=Object(l.a)(e,["tag","size","children","className"]);return Object(d.jsx)(t,Object(u.a)(Object(u.a)({className:Object(h.a)({"text-3xl":1===n,"text-xl":2===n},r)},c),{},{children:a}))};w.defaultProps={tag:"span"};var N=w,k=function(e){var t=e.className,n=Object(l.a)(e,["className"]);return Object(d.jsx)("input",Object(u.a)({className:Object(h.a)("border rounded p-2 w-full bg-white",t)},n))},C={multipleChoice:function(e){var t=e.value,n=e.question,a=e.onChange,r=function(e){a(e.target.value)};return Object(d.jsxs)("div",{children:[Object(d.jsx)(N,{tag:"h1",className:"mb-4",size:1,children:n.title}),n.getChoices().map((function(e){return Object(d.jsxs)("div",{className:"mb-1",children:[Object(d.jsx)("input",{name:n.id,id:e.value,value:e.value,checked:t===e.value,onChange:r,type:"radio"}),Object(d.jsx)("label",{className:"ml-2",htmlFor:e.value,children:e.label})]},e.value)}))]})},simple:function(e){var t=e.question,n=e.value,a=e.onChange;return Object(d.jsxs)("div",{children:[Object(d.jsx)(N,{tag:"h1",size:1,children:t.title}),Object(d.jsx)(k,{type:t.fieldType,className:"my-3",value:n||"",placeholder:t.placeholder,onChange:function(e){a(e.target.value)}})]})}},S=function(e){var t=e.current,n=e.onNextQuestion,r=e.onFinalize,c=y(),i=c.getQuestionUseCase,s=c.answerQuestionUseCase,o=c.getStoredAnswersUseCase,u=c.authenticateUserUseCase,l=i.execute(t),h=Object(a.useState)(null),b=Object(m.a)(h,2),O=b[0],x=b[1],w=Object(a.useState)(null),N=Object(m.a)(w,2),k=N[0],S=N[1];if(Object(a.useEffect)((function(){x((null===l||void 0===l?void 0:l.value)||null),S(null)}),[l]),!l)return Object(d.jsx)("div",{children:"Could not find any question."});var U=function(){try{s.execute(l,O)}catch(e){S(e.message)}},E=function(){var e=Object(p.a)(v.a.mark((function e(){var t;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return U(),e.prev=1,t=o.execute(),e.next=5,u.execute({address:t.address,email:t.email,firstName:t.firstName,numberOfChildren:t.numberOfChildren&&Number(t.numberOfChildren),occupation:t.occupation});case 5:r(),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),S(e.t0.message);case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(){return e.apply(this,arguments)}}(),A=C[l.type];return A?Object(d.jsx)(f,{children:Object(d.jsxs)(g,{children:[Object(d.jsx)(A,{question:l,value:O,onChange:function(e){x(e)}}),k&&Object(d.jsx)("div",{children:k}),Object(d.jsxs)("div",{className:"mt-4",children:[l.getNext()&&Object(d.jsx)(j,{onClick:function(){U(),n(l.getNext())},disabled:!O,children:"Next"}),!l.getNext()&&Object(d.jsx)(j,{onClick:E,disabled:!O,children:"Submit"})]})]})}):Object(d.jsx)("div",{children:"There is no corresponding component for that type of question. Did you forget to register it?"})};S.defaultProps={onNextQuestion:function(){},onFinalize:function(){}};var U=S,E=function(){var e=Object(o.h)(),t=Object(o.g)(),n=e.id,a=function(){var e=Object(p.a)(v.a.mark((function e(){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.push("/recommendation");case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(d.jsx)(U,{current:n,onNextQuestion:function(e){t.push("/question/".concat(e.id))},onFinalize:a})},A=function(){var e=y().getQuestionUseCase.execute();return Object(d.jsx)(o.a,{to:"/question/".concat(e.id)})},T=function(e){var t=e.recommendation,n={HEALTH_INSURANCE:"Health insurance",HOME_CONTENT:"Home content",PRIVATE_LIABILITY:"Private liability",MONTH:"month",YEAR:"year"};return Object(d.jsxs)("div",{className:"border p-4 mb-2 flex justify-between",children:[Object(d.jsx)("div",{children:n[t.type]}),Object(d.jsxs)("div",{children:["\u20ac",t.price.amount," per ",n[t.price.periodicity]]})]})},q=function(){var e=y(),t=e.getUserTokenUseCase,n=e.getAllRecommendationsUseCase,r=Object(a.useState)(null),c=Object(m.a)(r,2),i=c[0],s=c[1],o=Object(a.useState)(null),u=Object(m.a)(o,2),l=u[0],h=u[1],j=t.execute();return Object(a.useEffect)((function(){j?function(){var e=Object(p.a)(v.a.mark((function e(){var t;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.execute(j);case 2:t=e.sent,h(t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()():s("Not authenticated")}),[n,j]),Object(d.jsx)(f,{children:Object(d.jsxs)(g,{children:[Object(d.jsx)(N,{className:"mb-2",tag:"h1",size:1,children:"We got your recommendation"}),Object(d.jsx)(N,{className:"mb-4",tag:"h2",size:2,children:"Based on your answers, this is what makes sense for you and what you should pay."}),i&&Object(d.jsx)("div",{children:i}),null===l||void 0===l?void 0:l.map((function(e){return Object(d.jsx)(T,{recommendation:e},e.type)}))]})})},L=function(){return Object(d.jsx)(q,{})};var z=function(){return Object(d.jsx)(s.a,{basename:"/questionnaire-coding-challenge",children:Object(d.jsxs)(o.d,{children:[Object(d.jsx)(o.b,{exact:!0,path:"/",children:Object(d.jsx)(b,{})}),Object(d.jsx)(o.b,{exact:!0,path:"/question",children:Object(d.jsx)(A,{})}),Object(d.jsx)(o.b,{path:"/question/:id",children:Object(d.jsx)(E,{})}),Object(d.jsx)(o.b,{path:"/recommendation",children:Object(d.jsx)(L,{})})]})})},I=n(2),R=n(4),Q=n(15),P=n(17),D=function(){function e(t,n){Object(I.a)(this,e),this.id=t,this.title=n,this.value=null,this.type=void 0,this.next=null}return Object(R.a)(e,[{key:"getNext",value:function(){return"function"===typeof this.next?this.next(this.value):this.next}},{key:"setNext",value:function(e){this.next=e}}]),e}(),F=function(e){Object(Q.a)(n,e);var t=Object(P.a)(n);function n(){var e;Object(I.a)(this,n);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).choices=[],e.type="multipleChoice",e}return Object(R.a)(n,[{key:"getChoices",value:function(){return this.choices}},{key:"addChoice",value:function(e){this.choices.push(e)}},{key:"answer",value:function(e){this.value=e}}]),n}(D),H=function(e){Object(Q.a)(n,e);var t=Object(P.a)(n);function n(){var e;Object(I.a)(this,n);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).type="simple",e.placeholder="Type something...",e.mandatory=!1,e.fieldType="text",e}return Object(R.a)(n,[{key:"answer",value:function(e){if(this.mandatory&&!(null===e||void 0===e?void 0:e.length))throw new Error("This field is mandatory.");this.value=e}}]),n}(D),B=new H("firstName","What's your first name?");B.mandatory=!0,B.placeholder="Jane";var J=new H("address","What's your address?");J.placeholder="Lohm\xfchlenstra\xdfe 65";var M=new F("occupation","What's your occupation?");M.addChoice({label:"Employed",value:"EMPLOYED"}),M.addChoice({label:"Self-Employed",value:"SELF_EMPLOYED"}),M.addChoice({label:"Student",value:"STUDENT"});var W=new F("children","Do you have any children?");W.addChoice({label:"Yes",value:"yes"}),W.addChoice({label:"No",value:"no"});var Y=new H("numberOfChildren","How many children do you have?");Y.fieldType="number",Y.placeholder="2",Y.mandatory=!0;var _=new H("email","What's your email?");_.mandatory=!0,_.fieldType="email",_.placeholder="jane.doe@feather-insurance.com",B.setNext(J),J.setNext(M),M.setNext(W),W.setNext((function(e){return"yes"===e?Y:_})),Y.setNext(_);var G=[B,J,M,W,Y,_],V=function(){function e(t,n){Object(I.a)(this,e),this.repository=t,this.storage=n}return Object(R.a)(e,[{key:"execute",value:function(e){var t=e?this.repository.findByID(e):this.repository.first();if(!t)throw new Error("Could not find question");var n=this.storage.load(t.id);if(n)try{t.answer(n)}catch(a){console.warn("Something wrong with data loaded from localStorage, ignoring answer...")}return t}}]),e}(),K=function(){function e(t,n){Object(I.a)(this,e),this.repository=t,this.storage=n}return Object(R.a)(e,[{key:"execute",value:function(e,t){e.answer(t),this.storage.save(e.id,t)}}]),e}(),X=function(){function e(t){Object(I.a)(this,e),this.key=t}return Object(R.a)(e,[{key:"save",value:function(e,t){var n=this.loadAll();n[e]=t,localStorage.setItem(this.key,JSON.stringify(n))}},{key:"load",value:function(e){return this.loadAll()[e]}},{key:"loadAll",value:function(){return this.getFromLocalStorage()}},{key:"getFromLocalStorage",value:function(){var e=localStorage.getItem(this.key);return e?JSON.parse(e):{}}}]),e}(),Z=function(){function e(){Object(I.a)(this,e),this.questions=[]}return Object(R.a)(e,[{key:"add",value:function(e){this.questions.push(e)}},{key:"first",value:function(){return this.questions[0]}},{key:"findByID",value:function(e){return this.questions.find((function(t){return t.id===e}))}}]),e}(),$=function(){function e(t,n){Object(I.a)(this,e),this.repository=t,this.storage=n}return Object(R.a)(e,[{key:"execute",value:function(){var e=Object(p.a)(v.a.mark((function e(t){var n,a;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.repository.authenticate(t);case 2:n=e.sent,a=n.jwt,this.storage.save("token",a);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),ee=function(){function e(t){Object(I.a)(this,e),this.httpService=t}return Object(R.a)(e,[{key:"authenticate",value:function(e){return this.httpService.post("/user",e)}}]),e}(),te=n(30),ne=function(e){Object(Q.a)(n,e);var t=Object(P.a)(n);function n(){return Object(I.a)(this,n),t.apply(this,arguments)}return n}(Object(te.a)(Error)),ae=function(){function e(t){Object(I.a)(this,e),this.baseUrl=t}return Object(R.a)(e,[{key:"getApiURL",value:function(e){return new URL(this.baseUrl+e).href}},{key:"get",value:function(e,t){return fetch(this.getApiURL(e),{method:"GET",headers:null===t||void 0===t?void 0:t.headers}).then((function(e){if(!e.ok)throw new ne("Retrieving data was not successful.");return e.json()}))}},{key:"post",value:function(e,t,n){return fetch(this.getApiURL(e),{method:"POST",headers:Object(u.a)({"Content-Type":"application/json"},null===n||void 0===n?void 0:n.headers),body:JSON.stringify(t)}).then((function(e){if(!e.ok)throw new ne("Sending data was not successful.");return e.json()}))}}]),e}(),re=function(){function e(t){Object(I.a)(this,e),this.repository=t}return Object(R.a)(e,[{key:"execute",value:function(){var e=Object(p.a)(v.a.mark((function e(t){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.repository.getAll(t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),ce=function(){function e(t){Object(I.a)(this,e),this.httpService=t}return Object(R.a)(e,[{key:"getAll",value:function(){var e=Object(p.a)(v.a.mark((function e(t){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.httpService.get("/recommendation",{headers:{Authorization:"Bearer ".concat(t)}}));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),ie=function(){function e(t){Object(I.a)(this,e),this.storage=t}return Object(R.a)(e,[{key:"execute",value:function(){return this.storage.loadAll()}}]),e}(),se=function(){function e(t){Object(I.a)(this,e),this.storage=t}return Object(R.a)(e,[{key:"execute",value:function(){return this.storage.load("token")}}]),e}(),oe=new X("myapp:answers"),ue=new X("myapp:user"),le=new ae("https://challenge-dot-popsure-204813.appspot.com"),he=new Z,de=new ee(le),je=new ce(le);G.forEach((function(e){return he.add(e)})),i.a.render(Object(d.jsx)(r.a.StrictMode,{children:Object(d.jsx)(x.Provider,{value:{authenticateUserUseCase:new $(de,ue),getAllRecommendationsUseCase:new re(je),getQuestionUseCase:new V(he,oe),answerQuestionUseCase:new K(he,oe),getStoredAnswersUseCase:new ie(oe),getUserTokenUseCase:new se(ue)},children:Object(d.jsx)(z,{})})}),document.getElementById("root"))}},[[42,1,2]]]);
//# sourceMappingURL=main.63789c51.chunk.js.map