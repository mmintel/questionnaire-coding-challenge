(this["webpackJsonpquestionnaire-coding-challenge"]=this["webpackJsonpquestionnaire-coding-challenge"]||[]).push([[0],{42:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),c=n(27),i=n.n(c),s=n(29),o=n(3),u=n(6),l=n(12),h=n(10),d=n(0),j=function(e){var t=e.className,n=e.disabled,a=Object(l.a)(e,["className","disabled"]);return Object(d.jsx)("button",Object(u.a)({className:Object(h.a)("bg-blue-700 py-2 px-4 text-white rounded-full hover:bg-blue-600 focus:outline-none",n?"opacity-50 cursor-auto":"cursor-pointer",t)},a))},f=function(e){var t=e.children,n=e.className,a=Object(l.a)(e,["children","className"]);return Object(d.jsx)("div",Object(u.a)(Object(u.a)({className:Object(h.a)("w-screen h-screen flex items-center justify-center flex-col",n)},a),{},{children:t}))},b=function(){var e=Object(o.g)();return Object(d.jsx)(f,{children:Object(d.jsx)(j,{onClick:function(){e.push("/question")},children:"Start Questionnaire"})})},O=n(7),p=n.n(O),v=n(11),m=n(18),x=r.a.createContext({}),y=function(){return Object(a.useContext)(x)},g=function(e){var t=e.variant,n=e.children,a=e.className,r=Object(l.a)(e,["variant","children","className"]);return Object(d.jsx)("div",Object(u.a)(Object(u.a)({className:Object(h.a)("p-4 rounded","error"===t&&"bg-red-200 text-red-500",a)},r),{},{children:n}))};g.defaultProps={variant:"error"};var w=g,N=function(e){var t=e.className,n=e.children,a=Object(l.a)(e,["className","children"]);return Object(d.jsx)("div",Object(u.a)(Object(u.a)({className:Object(h.a)("w-full max-w-2xl mx-auto my-8 px-2",t)},a),{},{children:Object(d.jsx)("div",{children:n})}))},k=function(e){var t=e.tag,n=e.size,a=e.children,r=e.className,c=Object(l.a)(e,["tag","size","children","className"]);return Object(d.jsx)(t,Object(u.a)(Object(u.a)({className:Object(h.a)({"text-3xl":1===n,"text-xl":2===n},r)},c),{},{children:a}))};k.defaultProps={tag:"span"};var C=k,S=function(e){var t=e.className,n=Object(l.a)(e,["className"]);return Object(d.jsx)("input",Object(u.a)({className:Object(h.a)("border rounded p-2 w-full bg-white",t)},n))},U={multipleChoice:function(e){var t=e.value,n=e.question,a=e.onChange,r=function(e){a(e.target.value)};return Object(d.jsxs)("div",{children:[Object(d.jsx)(C,{tag:"h1",className:"mb-4",size:1,children:n.title}),n.getChoices().map((function(e){return Object(d.jsxs)("div",{className:"mb-1",children:[Object(d.jsx)("input",{name:n.id,id:e.value,value:e.value,checked:t===e.value,onChange:r,type:"radio"}),Object(d.jsx)("label",{className:"ml-2",htmlFor:e.value,children:e.label})]},e.value)}))]})},simple:function(e){var t=e.question,n=e.value,a=e.onChange;return Object(d.jsxs)("div",{children:[Object(d.jsx)(C,{tag:"h1",size:1,children:t.title}),Object(d.jsx)(S,{type:t.fieldType,className:"my-3",value:n||"",placeholder:t.placeholder,onChange:function(e){a(e.target.value)}})]})}},E=function(e){var t=e.current,n=e.onNextQuestion,r=e.onFinalize,c=y(),i=c.getQuestionUseCase,s=c.answerQuestionUseCase,o=c.getStoredAnswersUseCase,u=c.authenticateUserUseCase,l=i.execute(t),h=Object(a.useState)(null),b=Object(m.a)(h,2),O=b[0],x=b[1],g=Object(a.useState)(null),k=Object(m.a)(g,2),C=k[0],S=k[1];if(Object(a.useEffect)((function(){x((null===l||void 0===l?void 0:l.value)||null),S(null)}),[l]),!l)return Object(d.jsx)("div",{children:"Could not find any question."});var E=function(){try{s.execute(l,O)}catch(e){S(e.message)}},A=function(){var e=Object(v.a)(p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return E(),e.prev=1,t=o.execute(),e.next=5,u.execute({address:t.address,email:t.email,firstName:t.firstName,numberOfChildren:"yes"===t.children&&t.numberOfChildren?Number(t.numberOfChildren):0,occupation:t.occupation});case 5:r(),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),S(e.t0.message);case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(){return e.apply(this,arguments)}}(),T=U[l.type];return T?Object(d.jsx)(f,{children:Object(d.jsx)(N,{children:Object(d.jsxs)("form",{onSubmit:function(e){e.preventDefault(),O&&(l.getNext()?(E(),n(l.getNext())):A())},children:[Object(d.jsx)(T,{question:l,value:O,onChange:function(e){x(e)}}),C&&Object(d.jsx)(w,{children:C}),Object(d.jsx)("div",{className:"mt-4",children:Object(d.jsx)(j,{type:"submit",disabled:!O,children:l.getNext()?"Next":"Submit"})})]})})}):Object(d.jsx)("div",{children:"There is no corresponding component for that type of question. Did you forget to register it?"})};E.defaultProps={onNextQuestion:function(){},onFinalize:function(){}};var A=E,T=function(){var e=Object(o.h)(),t=Object(o.g)(),n=e.id,a=function(){var e=Object(v.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.push("/recommendation");case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(d.jsx)(A,{current:n,onNextQuestion:function(e){t.push("/question/".concat(e.id))},onFinalize:a})},q=function(){var e=y().getQuestionUseCase.execute();return Object(d.jsx)(o.a,{to:"/question/".concat(e.id)})},L=function(e){var t=e.recommendation,n={HEALTH_INSURANCE:"Health insurance",HOME_CONTENT:"Home content",PRIVATE_LIABILITY:"Private liability",MONTH:"month",YEAR:"year"};return Object(d.jsxs)("div",{className:"border p-4 mb-2 flex justify-between",children:[Object(d.jsx)("div",{children:n[t.type]}),Object(d.jsxs)("div",{children:["\u20ac",t.price.amount," per ",n[t.price.periodicity]]})]})},z=function(){var e=y(),t=e.getUserTokenUseCase,n=e.getAllRecommendationsUseCase,r=Object(a.useState)(null),c=Object(m.a)(r,2),i=c[0],s=c[1],o=Object(a.useState)(null),u=Object(m.a)(o,2),l=u[0],h=u[1],j=t.execute();return Object(a.useEffect)((function(){j?function(){var e=Object(v.a)(p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.execute(j);case 2:t=e.sent,h(t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()():s("Not authenticated")}),[n,j]),Object(d.jsx)(f,{children:Object(d.jsxs)(N,{children:[Object(d.jsx)(C,{className:"mb-2",tag:"h1",size:1,children:"We got your recommendation"}),Object(d.jsx)(C,{className:"mb-4",tag:"h2",size:2,children:"Based on your answers, this is what makes sense for you and what you should pay."}),i&&Object(d.jsx)(w,{children:i}),null===l||void 0===l?void 0:l.map((function(e){return Object(d.jsx)(L,{recommendation:e},e.type)}))]})})},I=function(){return Object(d.jsx)(z,{})};var R=function(){return Object(d.jsx)(s.a,{basename:"/questionnaire-coding-challenge",children:Object(d.jsxs)(o.d,{children:[Object(d.jsx)(o.b,{exact:!0,path:"/",children:Object(d.jsx)(b,{})}),Object(d.jsx)(o.b,{exact:!0,path:"/question",children:Object(d.jsx)(q,{})}),Object(d.jsx)(o.b,{path:"/question/:id",children:Object(d.jsx)(T,{})}),Object(d.jsx)(o.b,{path:"/recommendation",children:Object(d.jsx)(I,{})})]})})},P=n(2),Q=n(4),D=n(15),F=n(17),H=function(){function e(t,n){Object(P.a)(this,e),this.id=t,this.title=n,this.value=null,this.type=void 0,this.next=null}return Object(Q.a)(e,[{key:"getNext",value:function(){return"function"===typeof this.next?this.next(this.value):this.next}},{key:"setNext",value:function(e){this.next=e}}]),e}(),B=function(e){Object(D.a)(n,e);var t=Object(F.a)(n);function n(){var e;Object(P.a)(this,n);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).choices=[],e.type="multipleChoice",e}return Object(Q.a)(n,[{key:"getChoices",value:function(){return this.choices}},{key:"addChoice",value:function(e){this.choices.push(e)}},{key:"answer",value:function(e){this.value=e}}]),n}(H),J=function(e){Object(D.a)(n,e);var t=Object(F.a)(n);function n(){var e;Object(P.a)(this,n);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).type="simple",e.placeholder="Type something...",e.mandatory=!1,e.fieldType="text",e}return Object(Q.a)(n,[{key:"answer",value:function(e){if(this.mandatory&&!(null===e||void 0===e?void 0:e.length))throw new Error("This field is mandatory.");this.value=e}}]),n}(H),M=new J("firstName","What's your first name?");M.mandatory=!0,M.placeholder="Jane";var W=new J("address","What's your address?");W.placeholder="Lohm\xfchlenstra\xdfe 65";var Y=new B("occupation","What's your occupation?");Y.addChoice({label:"Employed",value:"EMPLOYED"}),Y.addChoice({label:"Self-Employed",value:"SELF_EMPLOYED"}),Y.addChoice({label:"Student",value:"STUDENT"});var _=new B("children","Do you have any children?");_.addChoice({label:"Yes",value:"yes"}),_.addChoice({label:"No",value:"no"});var G=new J("numberOfChildren","How many children do you have?");G.fieldType="number",G.placeholder="2",G.mandatory=!0;var V=new J("email","What's your email?");V.mandatory=!0,V.fieldType="email",V.placeholder="jane.doe@feather-insurance.com",M.setNext(W),W.setNext(Y),Y.setNext(_),_.setNext((function(e){return"yes"===e?G:V})),G.setNext(V);var K=[M,W,Y,_,G,V],X=function(){function e(t,n){Object(P.a)(this,e),this.repository=t,this.storage=n}return Object(Q.a)(e,[{key:"execute",value:function(e){var t=e?this.repository.findByID(e):this.repository.first();if(!t)throw new Error("Could not find question");var n=this.storage.load(t.id);if(n)try{t.answer(n)}catch(a){console.warn("Something wrong with data loaded from localStorage, ignoring answer...")}return t}}]),e}(),Z=function(){function e(t,n){Object(P.a)(this,e),this.repository=t,this.storage=n}return Object(Q.a)(e,[{key:"execute",value:function(e,t){e.answer(t),this.storage.save(e.id,t)}}]),e}(),$=function(){function e(t){Object(P.a)(this,e),this.key=t}return Object(Q.a)(e,[{key:"save",value:function(e,t){var n=this.loadAll();n[e]=t,localStorage.setItem(this.key,JSON.stringify(n))}},{key:"load",value:function(e){return this.loadAll()[e]}},{key:"loadAll",value:function(){return this.getFromLocalStorage()}},{key:"getFromLocalStorage",value:function(){var e=localStorage.getItem(this.key);return e?JSON.parse(e):{}}}]),e}(),ee=function(){function e(){Object(P.a)(this,e),this.questions=[]}return Object(Q.a)(e,[{key:"add",value:function(e){this.questions.push(e)}},{key:"first",value:function(){return this.questions[0]}},{key:"findByID",value:function(e){return this.questions.find((function(t){return t.id===e}))}}]),e}(),te=function(){function e(t,n){Object(P.a)(this,e),this.repository=t,this.storage=n}return Object(Q.a)(e,[{key:"execute",value:function(){var e=Object(v.a)(p.a.mark((function e(t){var n,a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.repository.authenticate(t);case 2:n=e.sent,a=n.jwt,this.storage.save("token",a);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),ne=function(){function e(t){Object(P.a)(this,e),this.httpService=t}return Object(Q.a)(e,[{key:"authenticate",value:function(e){return this.httpService.post("/user",e)}}]),e}(),ae=n(30),re=function(e){Object(D.a)(n,e);var t=Object(F.a)(n);function n(){return Object(P.a)(this,n),t.apply(this,arguments)}return n}(Object(ae.a)(Error)),ce=function(){function e(t){Object(P.a)(this,e),this.baseUrl=t}return Object(Q.a)(e,[{key:"getApiURL",value:function(e){return new URL(this.baseUrl+e).href}},{key:"get",value:function(e,t){return fetch(this.getApiURL(e),{method:"GET",headers:null===t||void 0===t?void 0:t.headers}).then((function(e){if(!e.ok)throw new re("Retrieving data was not successful.");return e.json()}))}},{key:"post",value:function(e,t,n){return fetch(this.getApiURL(e),{method:"POST",headers:Object(u.a)({"Content-Type":"application/json"},null===n||void 0===n?void 0:n.headers),body:JSON.stringify(t)}).then((function(e){if(!e.ok)throw new re("Sending data was not successful.");return e.json()}))}}]),e}(),ie=function(){function e(t){Object(P.a)(this,e),this.repository=t}return Object(Q.a)(e,[{key:"execute",value:function(){var e=Object(v.a)(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.repository.getAll(t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),se=function(){function e(t){Object(P.a)(this,e),this.httpService=t}return Object(Q.a)(e,[{key:"getAll",value:function(){var e=Object(v.a)(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.httpService.get("/recommendation",{headers:{Authorization:"Bearer ".concat(t)}}));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),oe=function(){function e(t){Object(P.a)(this,e),this.storage=t}return Object(Q.a)(e,[{key:"execute",value:function(){return this.storage.loadAll()}}]),e}(),ue=function(){function e(t){Object(P.a)(this,e),this.storage=t}return Object(Q.a)(e,[{key:"execute",value:function(){return this.storage.load("token")}}]),e}(),le=new $("myapp:answers"),he=new $("myapp:user"),de=new ce("https://challenge-dot-popsure-204813.appspot.com"),je=new ee,fe=new ne(de),be=new se(de);K.forEach((function(e){return je.add(e)})),i.a.render(Object(d.jsx)(r.a.StrictMode,{children:Object(d.jsx)(x.Provider,{value:{authenticateUserUseCase:new te(fe,he),getAllRecommendationsUseCase:new ie(be),getQuestionUseCase:new X(je,le),answerQuestionUseCase:new Z(je,le),getStoredAnswersUseCase:new oe(le),getUserTokenUseCase:new ue(he)},children:Object(d.jsx)(R,{})})}),document.getElementById("root"))}},[[42,1,2]]]);
//# sourceMappingURL=main.84fc7840.chunk.js.map